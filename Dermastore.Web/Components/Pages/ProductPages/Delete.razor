@page "/products/delete"
@using Dermastore.Application.Commands.Products
@using Microsoft.EntityFrameworkCore
@using Dermastore.Domain.Entities
@rendermode InteractiveServer
@inject NavigationManager NavigationManager
@inject IMediator Mediator
@using MediatR

<PageTitle>Delete Product</PageTitle>

<div class="container mt-5">
    <div class="card shadow-lg p-4 text-center">
        <h2 class="text-danger">Delete Product</h2>
        <hr />
        <p class="lead">Are you sure you want to delete this product?</p>
        
        <div class="d-flex justify-content-center gap-3 mt-4">
            <button class="btn btn-danger" @onclick="DeleteProduct">Delete</button>
            <a href="/products" class="btn btn-outline-secondary">Back to List</a>
        </div>
    </div>
</div>

@code {
    [SupplyParameterFromQuery]
    private int Id { get; set; }

    private async Task DeleteProduct()
    {
        var command = new DeleteProductCommand(Id);
        var result = await Mediator.Send(command);

        if (!result)
        {
            NavigationManager.NavigateTo("notfound");
        }

        NavigationManager.NavigateTo("/products");
    }
}